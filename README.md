# Efficient querying from weighted binary codes
This repository contains the C++ code for the query method proposed in our paper:
"Efficient Querying from Weighted Binary Codes". Zhenyu Weng, Yuesheng Zhu. AAAI 2020(oral).

## Overview ##
This method is a fast nearest neighbor search method for weighted binary codes based on the multi-index tables[1].

## Building ##
Requisites: C++

Data Dir:  
* databin32.txt and testbin32.txt contain the binary codes generated by Spherical Hashing(SPH)[2] from the GIST1M dataset. 
* weight32.txt contains the weights for each query generated by Asymmetric Distance for Spherical Hashing[3].

Command: 
Building
``` 
$ g++ array32.cpp -c
$ g++ bucket_group.cpp -c
$ g++ sparse_hashtable.cpp -c
$ g++ MIWQ.cpp -c
$ g++ array32.o bucket_group.o sparse_hashtable.o MIWQ.o -o MIWQ
```
Then running MIWQ and using pre.cpp file to check the precision.
```
$ file name:data/groundtruth.txt
$ file name:32\MIWQ32_1_4_1000000_10000
$ accuracy with bit 32 and neighbor 1: 0.74040
$ file name:32\MIWQ32_10_4_1000000_10000
$ accuracy with bit 32 and neighbor 10: 0.67392
$ file name:32\MIWQ32_100_4_1000000_10000
$ accuracy with bit 32 and neighbor 100: 0.53894
```

## Reference ##
[1] Norouzi, M.; Punjani, A.; and Fleet, D. J. 2014. Fast exact search in hamming space with multi-index hashing. IEEE Trans. on Pattern Anal. and Mach. Intell. 36(6):1107–1119.
[2] Heo J.; Lee Y.; He J.; Chang S.; Yoon s. 2015. Spherical Hashing: Binary Code Embedding with Hyperspheres. IEEE Trans. on Pattern Anal. and Mach. Intell. 37(11):2304-2316.
[3] Weng, Z.; Yao, W.; Sun, Z.; and Zhu, Y. 2016. Asymmetric distance for spherical hashing. In Proceedings of the IEEE International Conference on Image Processing, 206–210. 

Please cite:
```
@proceeding{weng2020querying,
  title={Efficient Querying From Weighted Binary Codes},
  author={Zhenyu Weng, Yuesheng Zhu},
  booktitle={AAAI},
  year={2020}
}
```

## Contact ##
- Zhenyu Weng (Peking University)
- wzytumbler@pku.edu.cn
